<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>RENUOVA - Live</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- 1. Firebase ki Libraries -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<style>
/* Aapka purana saara design (CSS) yahan hai */
body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;background:#f1f3f6;}
header{background:#2874f0;color:#fff;padding:14px;text-align:center;font-size:22px;font-weight:700;cursor:pointer;}
.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;padding:12px;}
.card{background:#fff;border-radius:10px;padding:8px;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,.1);transition:.2s;}
.card:active{transform:scale(.97)}
.card img{width:100%;height:170px;object-fit:contain;border-radius:8px;}
.card h3{margin:6px 0 2px;font-size:15px;font-weight:600;}
.card p{margin:0;color:#388e3c;font-weight:700;}
.page{display:none;padding:12px}
.slider{position:relative;background:#fff;padding:10px;border-radius:12px;box-shadow:0 2px 6px rgba(0,0,0,.1);}
.slider img{width:100%;height:280px;object-fit:contain;border-radius:10px;}
.arrow{position:absolute;top:50%;transform:translateY(-50%);background:#fff;color:#000;padding:8px 12px;border-radius:50%;cursor:pointer;font-size:18px;box-shadow:0 2px 6px rgba(0,0,0,.3);}
.left{left:8px}.right{right:8px}.hide{display:none}
#pprice{color:#388e3c;font-size:20px;margin:6px 0;}
.btn{background:#fb641b;color:#fff;padding:14px;text-align:center;border-radius:8px;margin-top:12px;text-decoration:none;display:block;font-weight:700;}
.btn.dark{background:#2874f0}
input,textarea{width:100%;padding:10px;margin:6px 0;border-radius:6px;border:1px solid #ccc;}
table{width:100%;border-collapse:collapse;background:#fff;margin-top:10px;}
th,td{border:1px solid #ddd;padding:8px;text-align:center;}
th{background:#f0f0f0}
</style>
</head>

<body>

<header id="logo">RENUOVA</header>

<div id="home" class="grid">Loading Products...</div>

<div id="product" class="page">
<button class="btn dark" onclick="goHome()">⬅ Back</button>
<div class="slider">
<img id="slideImg">
<div class="arrow left" onclick="prevImg()">‹</div>
<div class="arrow right" onclick="nextImg()">›</div>
</div>
<h2 id="pname"></h2>
<h3 id="pprice"></h3>
<p id="pdetails"></p>
<p><b>Warranty:</b> <span id="pwarranty"></span></p>
<a id="buy" class="btn" target="_blank">Buy on WhatsApp</a>
</div>

<div id="adminList" class="page">
<h2>Admin – Product List</h2>
<button class="btn dark" onclick="goHome()">⬅ Back</button>
<button class="btn" onclick="addNew()">➕ Add New</button>
<table>
<thead><tr><th>No</th><th>Name</th><th>Price</th><th>Edit</th><th>Delete</th></tr></thead>
<tbody id="plist"></tbody>
</table>
</div>

<div id="adminEdit" class="page">
<h2 id="formTitle"></h2>
<button class="btn dark" onclick="openAdminList()">⬅ Back</button>
<input id="aname" placeholder="Name">
<input id="aprice" placeholder="Price">
<input id="img1" placeholder="Image 1 URL">
<input id="img2" placeholder="Image 2 URL">
<input id="img3" placeholder="Image 3 URL">
<input id="img4" placeholder="Image 4 URL">
<textarea id="adetails" placeholder="Details"></textarea>
<input id="awarranty" placeholder="Warranty">
<button class="btn" onclick="save()">Save Live</button>
</div>

<script>
// 2. AAPKA FIREBASE CONFIG (Jo aapne photo bheji)
const firebaseConfig = {
  apiKey: "AIzaSyBzfvl9ZcvApNZf7kFih7oCvGkYLSAKm0",
  authDomain: "nuova-87735.firebaseapp.com",
  databaseURL: "https://nuova-87735-default-rtdb.firebaseio.com",
  projectId: "nuova-87735",
  storageBucket: "nuova-87735.firebasestorage.app",
  messagingSenderId: "299058177938",
  appId: "1:299058177938:web:a0bcf1a1d141fe7a58434b"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);
const db = firebase.database().ref("products");

let products = [];
let click=0, editIndex=null, slideIndex=0, currentImgs=[], startX=0;

// --- DATABASE SE DATA UTHANA ---
db.on("value", (snapshot) => {
    products = snapshot.val() || [];
    loadHome();
    if(adminList.style.display === "block") renderList();
});

function loadHome(){
    const homeDiv = document.getElementById("home");
    homeDiv.innerHTML="";
    if(products.length === 0) homeDiv.innerHTML = "No Products Found.";
    products.forEach((x,i)=>{
        homeDiv.innerHTML+=`
        <div class="card" onclick="openP(${i})">
        <img src="${x.imgs[0]}">
        <h3>${x.n}</h3>
        <p>${x.p}</p>
        </div>`;
    });
}

window.openP=function(i){
    document.getElementById("home").style.display="none";
    document.getElementById("product").style.display="block";
    slideIndex=0;
    currentImgs=products[i].imgs;
    document.getElementById("slideImg").src=currentImgs[0];
    toggleArrow();
    document.getElementById("pname").innerText=products[i].n;
    document.getElementById("pprice").innerText=products[i].p;
    document.getElementById("pdetails").innerText=products[i].d;
    document.getElementById("pwarranty").innerText=products[i].w;
    document.getElementById("buy").href=`https://wa.me/9229288001?text=Hello,%0AProduct:${products[i].n}`;
}

// --- SAVE FUNCTION (DATABASE ME JAYEGA) ---
window.save = function(){
    let imgs=[img1.value, img2.value, img3.value, img4.value].filter(x=>x);
    let obj={n:aname.value, p:aprice.value, imgs:imgs.length?imgs:["https://picsum.photos/500"], d:adetails.value, w:awarranty.value};
    
    if(editIndex===null) products.push(obj);
    else products[editIndex]=obj;

    db.set(products).then(() => {
        alert("Success: Duniya bhar ke liye Save ho gaya!");
        openAdminList();
    });
}

// --- DELETE FUNCTION ---
window.del = function(i){
    if(confirm("Khatam kar du? (Delete)")){
        products.splice(i,1);
        db.set(products);
    }
}

// --- Baki UI Functions ---
function toggleArrow(){
    const l=document.querySelector(".left"), r=document.querySelector(".right");
    if(currentImgs.length<=1){ l.classList.add("hide"); r.classList.add("hide"); }
    else { l.classList.remove("hide"); r.classList.remove("hide"); }
}
window.nextImg=()=>{ slideIndex=(slideIndex+1)%currentImgs.length; document.getElementById("slideImg").src=currentImgs[slideIndex]; }
window.prevImg=()=>{ slideIndex=(slideIndex-1+currentImgs.length)%currentImgs.length; document.getElementById("slideImg").src=currentImgs[slideIndex]; }
window.goHome=()=>{ product.style.display="none"; adminList.style.display="none"; adminEdit.style.display="none"; home.style.display="grid"; }
logo.onclick=()=>{ click++; if(click===10){ if(prompt("Password?")==="nitish20086"){ home.style.display="none"; adminList.style.display="block"; renderList(); } click=0; } }
function renderList(){
    plist.innerHTML="";
    products.forEach((x,i)=>{
        plist.innerHTML+=`<tr><td>${i+1}</td><td>${x.n}</td><td>${x.p}</td><td><button onclick="editProduct(${i})">Edit</button></td><td><button onclick="del(${i})">Del</button></td></tr>`;
    });
}
window.editProduct=(i)=>{ editIndex=i; formTitle.innerText="Edit Product"; adminList.style.display="none"; adminEdit.style.display="block"; aname.value=products[i].n; aprice.value=products[i].p; img1.value=products[i].imgs[0]||""; adetails.value=products[i].d; awarranty.value=products[i].w; }
window.addNew=()=>{ editIndex=null; formTitle.innerText="Add New"; adminList.style.display="none"; adminEdit.style.display="block"; aname.value=aprice.value=img1.value=img2.value=img3.value=img4.value=adetails.value=awarranty.value=""; }
window.openAdminList=()=>{ adminEdit.style.display="none"; adminList.style.display="block"; renderList(); }
</script>

</body>
</html>